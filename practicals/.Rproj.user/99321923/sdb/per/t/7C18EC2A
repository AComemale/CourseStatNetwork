{
    "collab_server" : "",
    "contents" : "---\ntitle: 'Practical 1 - Linear Regression Models'\nauthor: \"Julien Chiquet & Guillem Rigaill & Anastase Alexandre Charantonis\"\ndate: \"September 22th, 2016\"\noutput: pdf_document\n---\n\n#### Session's objectives\n\n- Master Simple Linear Models\n- Interpret the `R` outputs of such a model\n\n#### Remarks\n\n- The lab exercises must be perfomed in groups of two or three students.\n- You _must_ use `R studio`.\n- Using `R studio`,  create a `R markdown` file that will detail your work during the lab exercises. That file must be sent by mail to your respective lab monitors, and should include the code and the commentaries on its assosciated outputs.  A cheat sheet of the  markdown syntax can be found here: [https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)\n- Whenever possible, prefere the `ggplot2` library to the base plotting functions included in `R`.\n\n### For those new to `R`\n\nGo to the page: [http://tryr.codeschool.com/](http://tryr.codeschool.com/). Complete the tutorial.\n\n### Quick refresh of `R` basics\n\n1. **Vector Manipulation**. We remind you that $$ e^x = \\sum_{k\\geq 0} \\frac{x^k}{k!}.$$\nInsert in a vector named  `exp2` the 20 first elements of this sequence. Remove any values smaller than $10^{-8}$. Use the remaining value to give an estimation of $e^2$  and compare that value to `exp(2)`.\n\n2. **Data Simulation**. Using the `rnorm` function, (type `?rnorm` to get help on this function) generate a vector $X$ containing 100 samples of a normal distribution with a mean value of 2 and a variance of 1. Generate another vector, named $Y$ of the same size obtained by multiplying $X$ by $9.8$ and adding a Gausssian noise with a standard deviation of $10$. \n\n3. **Read and write a data file**. Put the vectors $X$ and $Y$ in a `data.frame`. Save that `data.frame` with the `write.table` command. Read the obtained table with the `read.table` command. Compare the matrix you obtained to the initial matrix.\n\n4. **Read and write a table in the RData format**. Put the vectors $X$ et $Y$ in a `data.frame`. Save the `data.frame` using the `save` command. Read it with the `load` command. Compare the matrix obtained to the initial one.\n\n5. **Scatter plot**. Trace the scatter plot of $Y$ versus $X$, first using the `plot` command then using the help of the `ggplot2` library.\n\n6. **Histogram**. Trace the histogram of $X$.\n\n7. **\"For\"\" loop**. A random variable follows a $\\chi^2$ distribution but we do not know its degree of freedom. We want to estimate this degree of freedom. Using the empirical mean of a sample of size $n$ estimate the degree of freedom. Use `R` to evaluate the quality of this estimator for $n=3$ and $n=100$. Use a `for` loop.\n\n8. **Alternative \"For\" loop** (faster, more elegant, more adapted to `R`). Do the same thing with the `sapply` function.\n\n### Simple linear regression: Northern pike and DDT\n\nDDT (dichlorodiphenyltrichloroethane) is a relativelly potent pesticide. It of a toxic and non-biodegradable nature and can accumulate in the liver of some adipose tissue. We study here the effect of its accumulation on the Northern pike (*Brochet* in french).\n\n#### 1. Preliminaries\n\na) Import the data from 'Brochet.txt'.\n\nb) Calculate the mean, median and variance of the age of the Northern pike and of their accumulation of DDT.\n\nc) Plot the histograms of the age of the Northern pike and of their accumulation of DDT.\n\nd) Draw the scatter plot of the accumulation of DDT in the Northern pike versus their age.\n\ne) Make a bloxplot of the accumulation of DDT in the Northern pike versus their age. What do you observe? \n\nf) Calulate the variance of the concentration of DDT in each age group.\n\n#### 2. A first model\n\na) Create a linear regression model to explain the concentration of DDT in a Northern pike based on its age.\n\nb) Use `R` to estimate the parameters of this model. First apply the formulation given in the lecture, then use the  `lm` function. Calculate the slope, bias and residual variance.\n\nc) Test the parameters of the model. Make a variance analysis. Calculate `manually` the Fisher score and the $r^2$ coefficient.\n\nd) Plot the linear regression. Add confidence intervals. Calculate those first by applying the formulas from in the lecture and then by using the `predict`command. \n\ne) Plot a graph of the residues to evaluate the pertience of your model and perform a diagnostics. You can also use the `plot` function of `R` applied to the outputs of the `lm` function.\n\n#### 3. Square function Modeling \n\na) Create a new linear regression model to explain the concentration of DDT in a Northern pike based on the square of its age.\n\nb) Use `R` to estimate the parameters of this model.\n\nc) Test the model's parameters and perform a analysis of variance.\n\nd) Plot the regression line. You can use the `geom_smooth` function of `ggplot`.\n\ne) Perform a diagnostic of the model.\n\n#### 4. Logarithmic transformation model\n\na) Create a new linear regression model to explain the log of the concentration of DDT in a Northern pike based on its age.\n\nb) Trace the box-plot of the log of the DTT concentration in Northern pike as a function of its age. What do you notice?\n\nc) Calculate the variance of the **log** of the DDT concentration in each age group.\n\nd) Use `R` to estimate the parameters of this model.\n\ne) Test the model's parameters and perform an analysis of variance.\n\nf) Plot the regression line. You can use the `geom_smooth` function of `ggplot`.\n\ng) Perform a model diagnostic.\n\n#### 5. Towards a multi-linear regression\n\na) Create a new linear regression model to explain the log of the concentration of DDT in a Northern pike based on its age and the square of its age.\n\nb) Use `R` to estimate the parameters of this model. \n\nc) Test the parameters of the model. Perform an analysis of variance to compare the 3 models M2, M3, M4 (log, + Age, + square of the Age).\n\nd) Plot the regression curve.\n\ne) Validate your hypotheses. Use `R` to evaluate the relevance of the model. What are your thoughts?\n\n### For fast students : numerical maximization of likelihood\n  \nLet us consider a phenomenon that can be modeled by a normal distribution:  $\\mathcal{N}(\\mu,\\sigma^2)$. \n\n1. Analytically calculate $\\log L(x_1,\\dots,x_n;\\mu,\\sigma^2)$.\n2.  Determine the maximum likelihood estimators by successivelly deriving  $\\log  L$   with respect to   $\\mu$  and $\\sigma^2$. \n3. Simulate a gaussian sample of size $n=100$ with a mean of $\\mu=\\pi/2$ and a standard deviation of  $\\sigma=\\sqrt{2}$. Calculate the values of the  maximum likelihood estimators of $\\mu$ and $\\sigma^2$ obtained in the previous questions.\n4. Create a `loglikelihood` function that takes as inputs `x,mu,sigma`   and returns the value of the log-likelihood given $(x_1,\\dots,x_n), \\mu$ and $\\sigma$.\n5. Using the `optimize` function, numericaly estimate the values of $\\mu$ and $\\sigma$  that maximize the `loglikelihood` function.\n6. In the same figure, plot the\n    - histogram of the data,\n    - $\\log L$ function for a fixed $\\sigma$ equal to its true value, while homogenously sampling $\\mu$          in the $[\\pi/2-\\varepsilon,\\pi/2+\\varepsilon]$ interval;  also include the values that were analytically and numerically estimated (use `abline`).\n    -  $\\log  L$ function for a fixed $\\mu$, while homogenously sampling $\\sigma$ in the $[\\sqrt{2}-\\varepsilon,\\sqrt{2}+\\varepsilon]$ interval; also include the values that were analytically and numerically estimated (use `abline`).   Add the corrected empirical variance.\n7.  Create a  `logL` matrix, containing the values of the log-likelyhood by simultaneously varying $\\mu$ and $\\sigma$. Create a list  `data=list(x,y,z)` and use `persp`, `contour`, `image`  to visulize the results in 3D and 2D.\n",
    "created" : 1507289967681.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1752208207",
    "id" : "7C18EC2A",
    "lastKnownWriteTime" : 1474391257,
    "last_content_update" : 1474391257,
    "path" : "~/Documents/Teachings/2016-2017/MLG-ENSIIE/td-en/td1_regression_lineaire/td1_linear_regression_EN.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}